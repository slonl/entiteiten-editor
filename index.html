<!doctype html>
<html>
<head>
    <title>Entiteiten editor</title>
    <meta charset="utf-8">
    <script
      src="https://code.jquery.com/jquery-3.4.1.min.js"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
      crossorigin="anonymous"></script>
    <link rel="stylesheet" href="js/vanillaSelectBox.css">
    <style>

        .slo-treeview .vsb-main button {
            margin-left: 10px;
            color: #333;
            background: white !important;
            height: calc(var(--line-height) * 1.5);
            box-sizing: border-box;
            border: 1px solid var(--input-border) !important;
            line-height: inherit;
            font-size: inherit;
            padding: 0.5em;
        }
        .slo-treeview .vsb-main {
            width: 50% !important;
            flex-shrink: 0;
        }        
        .slo-treeview .vsb-main .title {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            width: 95%;
            display: inline-block;
        }
        .slo-treeview .vsb-menu {
            position: absolute;
            top: auto !important;
            width: 100%;
            left: 10px !important;
            border-radius: 0;
        }
    </style>
    <script src="js/vanillaSelectBox.js"></script>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        html,body {
            padding: 0;
            margin: 0;
        }
        html {
            height: 100%;
        }
        body {
            min-height: 100%;
        }
        .slo-commit,
        .slo-new {
            width: 100%;
        }
        .slo-right {
            margin-left: 0;
        }
        .slo-entiteit-changes {
            overflow-y: auto;
        }
        .slo-title:empty:before {
            content: "(Geen titel)";
        }
        .slo-entiteit-changes a {
            color: inherit;
            padding: inherit;
        }
        .slo-entiteit-change .slo-type {
            margin-left: 5px;
            max-width: 170px;
        }
        .slo-entity-select {
            display: inline-flex;
            max-width: 200px;
            padding: 0;
            padding-right: 30px;
            margin: 0;
            height: 28px;
            margin-top: -2px;
        }
        .slo-id:empty:before {
            content: "(Nieuw UUID)";
        }
        .slo-warning:not(:empty) + .slo-warning {
            display: none;
        }
        .slo-label {
            display: inline-block;
        }
        .slo-form-help {
            font-size: 0.8em;
            line-height: 1.5em;
        }
        label.slo-form-checkbox,
        label.slo-form-radio {
            padding-left: 1.5em;
        }
        .slo-form-checkbox input[type="checkbox"],
        .slo-form-radio input[type="radio"] {
            margin-left: -1.5em;
            position: absolute;
        }
        textarea[data-simply-activate="autosize"] {
            height: var(--slo-line-height);
            resize: none;
        }
        .slo-profile {
            display: grid;
            grid-template-areas: "avatar name" 
                                 "avatar button";
        }
        .slo-avatar {
            grid-area: avatar;        
            height: 40px;
            margin: 10px;
        }
        .slo-username {
            grid-area: name;
            line-height: 38px;
            height: 25px;
            display: block;
            white-space: nowrap;
        }
        .slo-logoff {
            grid-area: button;
            display: none;
            line-height: 20px;
        }
        body.slo-logged-on .slo-logoff {
            display: block;
        }
        .slo-hidden {
            display: none;
        }
        .slo-treeview {
            width: 50vw;
            height: 75vh;
            overflow-x: hidden;
            overflow-y: auto;
            float: left;
        }
        .slo-treeview-title {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: block;
            max-width: 100%;
            text-decoration: none;
            cursor: pointer;
            position: relative;
        }
        .slo-treeview-title .slo-title {
            line-height: 2em;
        }
        .slo-treeview-title.slo-selected .slo-title {
            text-decoration: underline;
        }
        .slo-treeview-children {
            padding-left: 1em;
        }
        .slo-treeview-filters {
            display: flex;
            flex-direction: row;
            position: sticky;
            top: 0;
            padding: 0 1em;
            background: white;
            z-index: 100;
        }
        .slo-treeview-tree {
            padding: 1em;
        }
        .slo-entity {
            height: 75vh;
            overflow-x: hidden;
            overflow-y: auto;
        }
        .slo-tag {
            vertical-align: middle;
        }
        .slo-tag a.slo-id {
            text-decoration: none;
            color: var(--font-color);
        }
        .slo-treeview .slo-tag {
            white-space: nowrap;
            max-width: 100px;
            overflow: hidden;
            text-overflow: ellipsis;
            direction: rtl;
        }
        .slo-button-naked {
            background: transparent;
            margin: 0;
        }
        .slo-remove-button {
            position: absolute;
            right: 2px;
            display: none;
            background-color: var(--brand);
            border-radius: 50%;
            padding: 4px;
            color: var(--brand-contrast);
            line-height: 1em !important;
            height: 2em;
            border: 3px solid white;
            width: 2em;
            margin-top: 2px;
            font-weight: bold;
            transition: all .2s ease;
        }
        .slo-remove-button:hover {
            color: var(--brand-contrast);
        }
        .slo-treeview-title:focus,
        .slo-treeview-title:hover {
            background-color: #EEE;
        }
        .slo-treeview-title:focus .slo-remove-button,
        .slo-treeview-title:hover .slo-remove-button {
            display: block;
        }
        .slo-treeview-title.slo-removed,
        .slo-removed {
            text-decoration: line-through;
        }
        .slo-removed .slo-remove-button {
            transform: rotate(45deg);
            background-color: blue;
        }
        .slo-add-button {
            background-color: var(--support);
            color: black;
            border-radius: 50%;
            padding: 4px;
        }
        .slo-tag input {
            display: inline-block;
            width: auto;
            padding: 0;
            height: auto;
        }
        .slo-main-page header {
            overflow: hidden;
        }
        .slo-parent-ids a ~ a:before {
            content: '';
            display: block;
        }
        ul.slo-nav-crumbs-block li {
            display: block;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
    </style>
    <!-- script src="https://cdn.lr-ingest.io/LogRocket.min.js" crossorigin="anonymous"></script -->
    <script>
        window.LogRocket && window.LogRocket.init('muze/entiteiten-editor');
    </script>
</head>
<body class="slo-main-page">
    <header class="slo-navbar">
        <nav class="slo-navbar-left slo-logo bg-brand-gradient">
            <a href="/"><img src="/assets/img/slo.png"></a>
        </nav>
        <div class="slo-navbar-left">
            OpenData Portal: Entiteit toevoegen
        </div>
        <div class="slo-navbar-right slo-profile">
            <img class="slo-avatar" data-simply-field="user.avatar_url">
            <div class="slo-username" data-simply-field="user.name"></div>
            <a href="#" class="slo-logoff" data-simply-command="logoff">Afmelden</a>
        </div>
    </header>
    <div class="slo-navbar slo-navbar-side bg-gray">
        <div class="slo-space">
            <button data-simply-command="new" class="slo-button slo-new">Nieuwe entiteit</button>
            <!-- button data-simply-command="multipleparents" class="slo-button slo-new">Toon meerdere parents</button -->
            <p>
                Aangepaste Entiteiten
        <div data-simply-field="changeCount" data-simply-content="template" data-simply-default-template="default">
            <template data-simply-template="0">
                        <textarea disabled placeholder="Commit message" data-simply-field="commitMessage"></textarea>
            </template>
            <template data-simply-template="default">
                <textarea placeholder="Commit message" data-simply-field="commitMessage"></textarea>
            </template>
        </div>
            </p>
            <p>
                <span data-simply-field="changeCount">0</span> aanpassingen
        <div data-simply-field="changeCount" data-simply-content="template" data-simply-default-template="default">
            <template data-simply-template="0">
                        <button disabled class="slo-button slo-commit">Verwerken</button>
            </template>
            <template data-simply-template="default">
                        <button data-simply-command="commit-changes" class="slo-button slo-commit">Verwerken</button>
            </template>
        </div>
            </p>
            <div class="slo-entiteit-changes" data-simply-list="changes">
                <template>
                    <div class="slo-entiteit-change">
                        <button data-simply-command="delete-change" class="slo-button slo-right">
                            <svg class="slo-icon slo-icon-feather">
                                <use xlink:href="/files/feather-sprite.svg#trash">
                                </use>
                            </svg>
                        </button>
                        <input type="checkbox" checked data-simply-field="commit" value=1>
                        <span class="slo-title" data-simply-field="title"></span><br>
                        <span class="slo-type" data-simply-field="section"></span><br>
                        <a href="#" class="slo-uuid" data-simply-field="id" data-simply-transformer="editlink"></a>
                    </div>
                </template>
            </div>
        </div>
    </div>
    <template id="relatie">
        <div class="slo-entiteit-relatie">
            <button data-simply-command="delete-relation" class="slo-button slo-right">
                <svg class="slo-icon slo-icon-feather">
                    <use xlink:href="/files/feather-sprite.svg#trash">
                    </use>
                </svg>
            </button>
            <span data-simply-field="relatie" data-simply-transformer="idToTitle"></span><br>
            <span class="slo-tag">
                <a class="slo-tag-label" href="#" data-simply-field="relatie" data-simply-transformer="opendatalink" data-simply-content="fixed" target="_blank">
                    <svg class="slo-icon slo-icon-feather"><use xlink:href="/files/feather-sprite.svg#link"></use></svg>
                </a>
                <a class="slo-id" href="#" data-simply-field="relatie" data-simply-transformer="editlink"></a>
            </span>
        </div>
    </template>
    <template id="entiteit-vakkencluster">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Vakken</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.vakleergebied_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="vakleergebied_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="vakleergebied">
                <button data-simply-command="add-relation" data-slo-relation="vakleergebeid_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Niveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.niveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="niveau">
                <button data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-leerlijn">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Vakken</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.vakleergebied_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="vakleergebied_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="vakleergebied">
                <button data-simply-command="add-relation" data-slo-relation="vakleergebied_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Niveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.niveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="niveau">
                <button data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>DoelNiveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doelniveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doelniveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doelniveau">
                <button data-simply-command="add-relation" data-slo-relation="doelniveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Vakinhouden</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.lpib_vakinhoud_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="lpib_vakinhoud" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="lpib_vakinhoud">
                <button data-simply-command="add-relation" data-slo-relation="lpib_vakinhoud_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-vakleergebied">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize"  data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize"  data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Prefix
            	<input data-simply-field="entity.prefix">
            </label>
            <label>Niveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.niveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="niveau">
                <button data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-lpib_vakleergebied">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize"  data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize"  data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Vakkernen</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.lpib_vakkern_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="lpib_vakkern_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="lpib_vakkern">
                <button data-simply-command="add-relation" data-slo-relation="lpib_vakkern_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Niveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.niveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="niveau">
                <button data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>DoelNiveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doelniveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doelniveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doelniveau">
                <button data-simply-command="add-relation" data-slo-relation="doelniveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-lpib_vakkern">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize"  data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Vaksubkernen</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.lpib_vaksubkern_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="lpib_vaksubkern" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="lpib_vaksubkern">
                <button data-simply-command="add-relation" data-slo-relation="lpib_vaksubkern_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>DoelNiveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doelniveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doelniveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doelniveau">
                <button data-simply-command="add-relation" data-slo-relation="doelniveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-lpib_vaksubkern">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Vakinhouden</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.lpib_vakinhoud_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="lpib_vakinhoud" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="lpib_vakinhoud">
                <button data-simply-command="add-relation" data-slo-relation="lpib_vakinhoud_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>DoelNiveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doelniveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doelniveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doelniveau">
                <button data-simply-command="add-relation" data-slo-relation="doelniveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-lpib_vakinhoud">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>DoelNiveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doelniveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doelniveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doelniveau">
                <button data-simply-command="add-relation" data-slo-relation="doelniveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-doelniveau">
        <div class="slo-entity">
            <label>Doelen</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doel_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doel" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doel">
                <button data-simply-command="add-relation" data-slo-relation="doel_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Niveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.niveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="niveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="niveau">
                <button data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Kerndoelen</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.kerndoel_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="kerndoel" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="kerndoel">
                <button data-simply-command="add-relation" data-slo-relation="kerndoel_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-doel">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Bron
                <input type="text" data-simply-field="entity.bron" placeholder="Bron">
            </label>
        </div>
    </template>
    <template id="entiteit-niveau">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Type
                <input type="text" data-simply-field="entity.type" placeholder="Niveau type">
            </label>
        </div>
    </template>

    <template id="entiteit-ldk_vakleergebied">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize"  data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize"  data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Vakkernen</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.ldk_vakkern_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="ldk_vakkern_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="ldk_vakkern">
                <button data-simply-command="add-relation" data-slo-relation="ldk_vakkern_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>DoelNiveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doelniveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doelniveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doelniveau">
                <button data-simply-command="add-relation" data-slo-relation="doelniveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-ldk_vakkern">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize"  data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Vaksubkernen</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.ldk_vaksubkern_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="ldk_vaksubkern" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="ldk_vaksubkern">
                <button data-simply-command="add-relation" data-slo-relation="ldk_vaksubkern_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>DoelNiveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doelniveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doelniveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doelniveau">
                <button data-simply-command="add-relation" data-slo-relation="doelniveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-ldk_vaksubkern">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Vakinhouden</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.ldk_vakinhoud_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="ldk_vakinhoud" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="ldk_vakinhoud">
                <button data-simply-command="add-relation" data-slo-relation="ldk_vakinhoud_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>DoelNiveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doelniveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doelniveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doelniveau">
                <button data-simply-command="add-relation" data-slo-relation="doelniveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-ldk_vakinhoud">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>DoelNiveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doelniveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doelniveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doelniveau">
                <button data-simply-command="add-relation" data-slo-relation="doelniveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>

    <template id="entiteit-examenprogramma">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Ingangsdatum
                <input type="text" data-simply-field="entity.ingangsdatum" placeholder="Examenprogramma Ingangsdatum">
            </label>
            <label>URL
                <input type="text" data-simply-field="entity.url" placeholder="Examenprogramma URL">
            </label>
            <label>Versie
                <input type="text" data-simply-field="entity.versie" placeholder="Examenprogramma Versie">
            </label>
            <label>Domein</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_domein_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_domein_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_domein">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_domein_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Vakleergebied</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_vakleergebied_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_vakleergebied_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_vakleergebied">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_vakleergebied_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Kop 1</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_kop1_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_kop1_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_kop1">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_kop1_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_domein">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <!--- aanwezig volgens context.json maar in praktijk niet
            <label>Ingangsdatum</label>
            <label>url</label>
            <label>versie</label>
            --->
            <label>Subdomein</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_subdomein_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_subdomein_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_subdomein">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_subdomein_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Eindterm</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_eindterm_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_eindterm_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_eindterm">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_eindterm_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_subdomein">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <!--- aanwezig volgens context.json maar in praktijk niet
            <label>Ingangsdatum</label>
            <label>url</label>
            <label>versie</label>
            --->
            <label>Eindterm</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_eindterm_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_eindterm_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_eindterm">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_eindterm_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_eindterm">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label class="slo-checkbox">
                <input type="checkbox" data-simply-field="entity.ce"> CE
            </label>
            <label class="slo-checkbox">
                <input type="checkbox" data-simply-field="entity.se"> SE
            </label>
            <label class="slo-checkbox">
                <input type="checkbox" data-simply-field="entity.kern"> Kern
            </label>
            <label class="slo-checkbox">
                <input type="checkbox" data-simply-field="entity.keuze"> Keuze
            </label>
            <!--- aanwezig volgens context.json maar in praktijk niet
            <label>Ingangsdatum</label>
            <label>url</label>
            <label>versie</label>
            --->
            <label>Niveau</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.niveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="niveau">
                <button data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_vakleergebied">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Vak</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.vakleergebied_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="vakleergebied_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="vakleergebied">
                <button data-simply-command="add-relation" data-slo-relation="vakleergebied_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
    </div>
    </template>
    <template id="entiteit-examenprogramma_kop1">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Kop 2</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_kop2_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="entity.examenprogramma_kop2_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_kop2">
                <button data-simply-command="add-relation" data-slo-relation="entity.examenprogramma_kop2_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Body</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_body_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_body_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_body">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_body_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Tag</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.tag_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="tag_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="tag">
                <button data-simply-command="add-relation" data-slo-relation="tag_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_kop2">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Kop 3</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_kop3_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="entity.examenprogramma_kop3_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_kop3">
                <button data-simply-command="add-relation" data-slo-relation="entity.examenprogramma_kop3_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Body</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_body_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_body_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_body">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_body_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Tag</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.tag_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="tag_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="tag">
                <button data-simply-command="add-relation" data-slo-relation="tag_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>

    <template id="entiteit-examenprogramma_kop3">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Kop 2 (niet volgens context.json)</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_kop2_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="entity.examenprogramma_kop2_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_kop2">
                <button data-simply-command="add-relation" data-slo-relation="entity.examenprogramma_kop2_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Kop 3 (niet volgens context.json)</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_kop3_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="entity.examenprogramma_kop3_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_kop3">
                <button data-simply-command="add-relation" data-slo-relation="entity.examenprogramma_kop3_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Kop 4</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_kop4_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="entity.examenprogramma_kop4_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_kop4">
                <button data-simply-command="add-relation" data-slo-relation="entity.examenprogramma_kop4_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Body</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_body_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_body_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_body">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_body_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Tag</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.tag_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="tag_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="tag">
                <button data-simply-command="add-relation" data-slo-relation="tag_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_kop4">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Body</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_body_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_body_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_body">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_body_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Tag</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.tag_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="tag_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="tag">
                <button data-simply-command="add-relation" data-slo-relation="tag_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_body">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Tag</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.tag_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="tag_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="tag">
                <button data-simply-command="add-relation" data-slo-relation="tag_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <!-- examenprogramma beroepsgericht -->
    <template id="entiteit-examenprogramma_bg_profiel">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Kern</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_bg_kern_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_kern_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_bg_kern">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_kern_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Module</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_bg_module_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_module_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_bg_module">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_module_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Keuzevak</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_bg_keuzevak_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_keuzevak_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_bg_keuzevak">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_keuzevak_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_bg_kern">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Kerndeel</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_bg_kerndeel_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_kerndeel_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_bg_kerndeel">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_kerndeel_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_bg_module">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Moduletaak</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_bg_moduletaak_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_moduletaak_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_bg_moduletaak">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_moduletaak_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Deeltaak</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_bg_deeltaak_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_deeltaak_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_bg_deeltaak">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_deeltaak_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_bg_keuzevak">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Keuzevaktaak</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_bg_keuzevaktaak_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_keuzevaktaak_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_bg_keuzevaktaak">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_keuzevaktaak_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Deeltaak</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_bg_deeltaak_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_deeltaak_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_bg_deeltaak">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_deeltaak_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_bg_kerndeel">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Globale Eindterm</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_bg_globale_eindterm_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_globale_eindterm_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_bg_globale_eindterm">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_globale_eindterm_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_bg_deeltaak">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Globale Eindterm</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_bg_globale_eindterm_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_globale_eindterm_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_bg_globale_eindterm">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_bg_globale_eindterm_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_bg_globale_eindterm">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Niveau</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.niveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="niveau">
                <button data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_bg_moduletaak">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Niveau</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.niveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="niveau">
                <button data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-examenprogramma_bg_keuzevaktaak">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Niveau</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.niveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-search slo-grid slo-grid-3">
                <input type="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="niveau">
                <button data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>



    <!-- kerndoelen -->
    <template id="entiteit-kerndoel">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>KerndoelLabel
            	<input type="text" data-simply-field="entity.kerndoelLabel">
            </label>
            <label>Niveau</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.niveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="niveau_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="niveau">
                <button data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-kerndoel_domein">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Kerndoel</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.kerndoel_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="kerndoel_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="kerndoel">
                <button data-simply-command="add-relation" data-slo-relation="kerndoel_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-kerndoel_uitstroomprofiel">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Tag</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.tag_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="tag_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="tag">
                <button data-simply-command="add-relation" data-slo-relation="tag_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-kerndoel_vakleergebied">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Domein</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.kerndoel_domein_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="kerndoel_domein_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="kerndoel_domein">
                <button data-simply-command="add-relation" data-slo-relation="kerndoel_domein_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Uitstroomprofiel</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.kerndoel_uitstroomprofiel_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="kerndoel_uitstroomprofiel_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="kerndoel_uitstroomprofiel">
                <button data-simply-command="add-relation" data-slo-relation="kerndoel_uitstroomprofiel_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Kerndoel</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.kerndoel_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="kerndoel_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="kerndoel">
                <button data-simply-command="add-relation" data-slo-relation="kerndoel_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Vak</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.vakleergebied_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="vakleergebied_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="vakleergebied">
                <button data-simply-command="add-relation" data-slo-relation="vakleergebied_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <!-- syllabus -->
    <template id="entiteit-syllabus">
        <div class="slo-entity">
            <label>Prefix
                <input type="text" data-simply-field="entity.prefix" placeholder="Entiteit prefix">
            </label>
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Examenprogramma</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Specifieke eindtermen</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.syllabus_specifieke_eindterm_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="syllabus_specifieke_eindterm_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="syllabus_specifieke_eindterm">
                <button data-simply-command="add-relation" data-slo-relation="syllabus_specifieke_eindterm_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Toelichting</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.syllabus_toelichting_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="syllabus_toelichting_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="syllabus_toelichting">
                <button data-simply-command="add-relation" data-slo-relation="syllabus_toelichting_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Vakbegrippen</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.syllabus_vakbegrip_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="syllabus_vakbegrip_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="syllabus_vakbegrip">
                <button data-simply-command="add-relation" data-slo-relation="syllabus_vakbegrip_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-syllabus_vakbegrip">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Examenprogramma</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma domein</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_domein_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_domein_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_domein">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_domein_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma subdomein</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_subdomein_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_subdomein_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_subdomein">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_subdomein_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma eindterm</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_eindterm_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_eindterm_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_eindterm">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_eindterm_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-syllabus_specifieke_eindterm">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Examenprogramma</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma domein</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_domein_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_domein_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_domein">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_domein_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma subdomein</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_subdomein_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_subdomein_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_subdomein">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_subdomein_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma eindterm</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_eindterm_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_eindterm_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_eindterm">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_eindterm_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>
    <template id="entiteit-syllabus_toelichting">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Examenprogramma</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma domein</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_domein_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_domein_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_domein">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_domein_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma subdomein</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_subdomein_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_subdomein_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_subdomein">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_subdomein_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma eindterm</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_eindterm_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_eindterm_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_eindterm">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_eindterm_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
        </div>
    </template>

    <template id="entiteit-leerlingtekst">
        <div class="slo-entity">
            <label>Titel
                <textarea data-simply-activate="autosize" data-simply-field="entity.title" placeholder="Entiteit titel"></textarea>
            </label>
            <label>Omschrijving
                <textarea data-simply-activate="autosize" data-simply-field="entity.description" placeholder="Entiteit omschrijving"></textarea>
            </label>
            <label>Vakken</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.vakleergebied_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="vakleergebied_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="vakleergebied">
                <button data-simply-command="add-relation" data-slo-relation="vakleergebied_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Vakkernen</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.lpib_vakkern_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="lpib_vakkern_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="lpib_vakkern">
                <button data-simply-command="add-relation" data-slo-relation="lpib_vakkern_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Vaksubkernen</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.lpib_vaksubkern_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="lpib_vaksubkern_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="lpib_vaksubkern">
                <button data-simply-command="add-relation" data-slo-relation="lpib_vaksubkern_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Vakinhouden</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.lpib_vakinhoud_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="lpib_vakinhoud_id" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="lpib_vakinhoud">
                <button data-simply-command="add-relation" data-slo-relation="lpib_vakinhoud_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>DoelNiveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doelniveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doelniveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doelniveau">
                <button data-simply-command="add-relation" data-slo-relation="doelniveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Doelen</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.doel_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="doel" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="doel">
                <button data-simply-command="add-relation" data-slo-relation="doel_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Niveaus</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.niveau_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form data-simply-command="add-relation" data-slo-relation="niveau" class="slo-search slo-grid slo-grid-3">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="niveau">
                <button data-simply-command="add-relation" data-slo-relation="niveau_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma domein</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_domein_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_domein_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_domein">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_domein_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma subdomein</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_subdomein_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
            <form class="slo-search slo-grid slo-grid-3" data-slo-relation="examenprogramma_subdomein_id">
                <input class="slo-grid-span-2" placeholder="Entiteit UUID / tekst" list="examenprogramma_subdomein">
                <button data-simply-command="add-relation" data-slo-relation="examenprogramma_subdomein_id" class="slo-button-nomargin slo-button">Toevoegen</button>
            </form>
            <label>Examenprogramma eindterm</label>
            <div class="slo-entiteit-relaties" data-simply-list="entity.examenprogramma_eindterm_id" data-simply-entry="relatie">
                <template rel="relatie"></template>
            </div>
        </div>
    </template>
    <datalist id="entities" data-simply-list="dataset.entities" data-simply-data="entities" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="vakleergebied" data-simply-list="dataset.vakleergebied" data-simply-data="vakleergebied" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="lpib_vakleergebied" data-simply-list="dataset.lpib_vakleergebied" data-simply-data="lpib_vakleergebied" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="lpib_vakkern" data-simply-list="dataset.lpib_vakkern" data-simply-data="lpib_vakkern" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="lpib_vaksubkern" data-simply-list="dataset.lpib_vaksubkern" data-simply-data="lpib_vaksubkern" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="lpib_vakinhoud" data-simply-list="dataset.lpib_vakinhoud" data-simply-data="lpib_vakinhoud" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="doelniveau" data-simply-list="dataset.doelniveau" data-simply-data="doelniveau" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="doel" data-simply-list="dataset.doel" data-simply-data="doel" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="niveau" data-simply-list="dataset.niveau" data-simply-data="niveau" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>

    <datalist id="ldk_vakleergebied" data-simply-list="dataset.ldk_vakleergebied" data-simply-data="ldk_vakleergebied" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="ldk_vakkern" data-simply-list="dataset.ldk_vakkern" data-simply-data="ldk_vakkern" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="ldk_vaksubkern" data-simply-list="dataset.ldk_vaksubkern" data-simply-data="ldk_vaksubkern" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="ldk_vakinhoud" data-simply-list="dataset.ldk_vakinhoud" data-simply-data="ldk_vakinhoud" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>

    <datalist id="examenprogramma" data-simply-list="dataset.examenprogramma" data-simply-data="examenprogramma" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="examenprogramma_domein" data-simply-list="dataset.examenprogramma_domein" data-simply-data="examenprogramma_domein" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="examenprogramma_subdomein" data-simply-list="dataset.examenprogramma_subdomein" data-simply-data="examenprogramma_subdomein" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="examenprogramma_eindterm" data-simply-list="dataset.examenprogramma_eindterm" data-simply-data="examenprogramma_eindterm" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>

    <datalist id="examenprogramma_bg_profiel" data-simply-list="dataset.examenprogramma_bg_profiel" data-simply-data="examenprogramma_bg_profiel" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="examenprogramma_bg_kern" data-simply-list="dataset.examenprogramma_bg_kern" data-simply-data="examenprogramma_bg_kern" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="examenprogramma_bg_module" data-simply-list="dataset.examenprogramma_bg_module" data-simply-data="examenprogramma_bg_module" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="examenprogramma_bg_keuzevak" data-simply-list="dataset.examenprogramma_bg_keuzevak" data-simply-data="examenprogramma_bg_keuzevak" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="examenprogramma_bg_kerndeel" data-simply-list="dataset.examenprogramma_bg_kerndeel" data-simply-data="examenprogramma_bg_kerndeel" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="examenprogramma_bg_deeltaak" data-simply-list="dataset.examenprogramma_bg_deeltaak" data-simply-data="examenprogramma_bg_deeltaak" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="examenprogramma_bg_moduletaak" data-simply-list="dataset.examenprogramma_bg_moduletaak" data-simply-data="examenprogramma_bg_moduletaak" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="examenprogramma_bg_keuzevaktaak" data-simply-list="dataset.examenprogramma_bg_keuzevaktaak" data-simply-data="examenprogramma_bg_keuzevaktaak" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="examenprogramma_bg_globale_eindterm" data-simply-list="dataset.examenprogramma_bg_globale_eindterm" data-simply-data="examenprogramma_bg_globale_eindterm" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>

    <datalist id="syllabus_vakbegrip" data-simply-list="dataset.syllabus_vakbegrip" data-simply-data="syllabus_vakbegrip" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="syllabus_toelichting" data-simply-list="dataset.syllabus_toelichting" data-simply-data="syllabus_toelichting" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>
    <datalist id="syllabus_specifieke_eindterm" data-simply-list="dataset.syllabus_specifieke_eindterm" data-simply-data="syllabus_specifieke_eindterm" data-simply-entry="entry"><template><option data-simply-transformer="searchoption" data-simply-field="entry"></option></template></datalist>

    <main class="slo-main slo-space-vertical">
        <div class="slo-grid slo-grid-4">
            <form data-simply-command="search" class="slo-grid slo-grid-span-3 slo-grid-3 slo-space">
                <input class="slo-grid-span-2" type="text" name="search" placeholder="Entiteit UUID / tekst" list="entities">
                <button data-simply-command="search" class="slo-button slo-button-nomargin" data-simply-command="search">Toon entiteit</button>
            </form>
            <div class="slo-grid slo-grid-2 slo-space">
            </div>
        </div>
        <div class="slo-grid slo-grid-4">
            <div class="slo-grid-span-4" data-simply-field="page" data-simply-content="template" data-simply-default-value="new">
            <template data-simply-template="edit">
                <article class="slo-card slo-grid-span-3">
                    <header class="slo-card-header slo-space">
                        <a href="#" class="slo-tag" data-simply-command="toggleTree">
                            <span class="slo-tag-label">
                                <svg class="slo-icon slo-icon-feather"><use xlink:href="/files/feather-sprite.svg#folder"></use></svg>
                            </span>
                            <span>Boomweergave</span>
                        </a>
                        <span class="slo-tag">
                            <a class="slo-tag-label" href="#" data-simply-field="entity.id" data-simply-transformer="opendatalink" data-simply-content="fixed" target="_blank">
                                <svg class="slo-icon slo-icon-feather"><use xlink:href="/files/feather-sprite.svg#link"></use></svg>
                            </a>
                            <span class="slo-id" data-simply-field="entity.id"></span>
                        </span>
                        <span class="slo-tag">
                            <label class="slo-tag-label">Type</label>
                            <span data-simply-field="entity.section"></span>
                        </span>
                        <span class="slo-right" data-simply-field="entity.deleted" data-simply-content="template" data-simply-default-template="0" data-simply-default-value="0">
                            <template data-simply-template="1">
                                <span class="slo-tag">Verwijderd</span>
                            </template>
                            <template data-simply-template="0">
                                <!-- span data-simply-field="entity.dirty" data-simply-content="template">
                                    <template data-simply-template="1">
                                        <span class="slo-tag">Inhoudelijk gewijzigd</span>
                                    </template>                                    
                                </span -->
                                <button class="slo-button slo-right slo-button-nomargin" data-simply-command="deprecate">
                                    <svg class="slo-icon slo-icon-feather">
                                        <use xlink:href="/files/feather-sprite.svg#trash">
                                        </use>
                                    </svg>
                                </button>
                            </template>
                        </span>
                        <span class="slo-right">
                            <button class="slo-button slo-right" data-simply-command="save">Bewaar</button>
                        </span>
                        <ul class="slo-nav-crumbs slo-nav-crumbs-block slo-space" data-simply-list="entity.parents">
                            <template>
                                <li data-simply-list="ids" class="slo-parent-ids">
                                    <template>
                                        <a href="#" data-simply-field="id" data-simply-transformer="editlink" data-simply-content="fixed"><span data-simply-field="id" data-simply-transformer="idToTitle"></span></a>
                                    </template>
                                </li>
                            </template>
                        </ul>
                    </header>
                    <div class="slo-treeview slo-hidden">
                        <div class="slo-treeview-filters">
                            <select class="slo-treeview-niveau" data-simply-list="niveaus" data-simply-command="filterNiveau">
                                <template>
                                    <option data-simply-field="niveau"></option>
                                </template>
                            </select>
                            <select class="slo-treeview-schemas" data-simply-activate="context-select" data-simply-list="schemas" data-simply-data="schemas" data-simply-command="filterSchemas" multiple>
                                <template>
                                    <option data-simply-field="schema"></option>
                                </template>
                            </select>
                        </div>
                        <div class="slo-treeview-tree"></div>
                    </div>
                    <div class="slo-card-body">
                        <div data-simply-field="entity.section" data-simply-content="template" data-simply-default-value="default">
                            <template data-simply-template="vakkencluster" rel="entiteit-vakkencluster"></template>
                            <template data-simply-template="leerlijn" rel="entiteit-leerlijn"></template>
                            <template data-simply-template="vakleergebied" rel="entiteit-vakleergebied"></template>
                            <template data-simply-template="lpib_vakleergebied" rel="entiteit-lpib_vakleergebied"></template>
                            <template data-simply-template="lpib_vakkern" rel="entiteit-lpib_vakkern"></template>
                            <template data-simply-template="lpib_vaksubkern" rel="entiteit-lpib_vaksubkern"></template>
                            <template data-simply-template="lpib_vakinhoud" rel="entiteit-lpib_vakinhoud"></template>
                            <template data-simply-template="doelniveau" rel="entiteit-doelniveau"></template>
                            <template data-simply-template="doel" rel="entiteit-doel"></template>
                            <template data-simply-template="niveau" rel="entiteit-niveau"></template>

                            <template data-simply-template="ldk_vakleergebied" rel="entiteit-ldk_vakleergebied"></template>
                            <template data-simply-template="ldk_vakkern" rel="entiteit-ldk_vakkern"></template>
                            <template data-simply-template="ldk_vaksubkern" rel="entiteit-ldk_vaksubkern"></template>
                            <template data-simply-template="ldk_vakinhoud" rel="entiteit-ldk_vakinhoud"></template>

                            <template data-simply-template="examenprogramma" rel="entiteit-examenprogramma"></template>
                            <template data-simply-template="examenprogramma_domein" rel="entiteit-examenprogramma_domein"></template>
                            <template data-simply-template="examenprogramma_subdomein" rel="entiteit-examenprogramma_subdomein"></template>
                            <template data-simply-template="examenprogramma_eindterm" rel="entiteit-examenprogramma_eindterm"></template>
                            <template data-simply-template="examenprogramma_kop1" rel="entiteit-examenprogramma_kop1"></template>
                            <template data-simply-template="examenprogramma_kop2" rel="entiteit-examenprogramma_kop2"></template>
                            <template data-simply-template="examenprogramma_kop3" rel="entiteit-examenprogramma_kop3"></template>
                            <template data-simply-template="examenprogramma_kop4" rel="entiteit-examenprogramma_kop4"></template>
                            <template data-simply-template="examenprogramma_body" rel="entiteit-examenprogramma_body"></template>
                            <template data-simply-template="examenprogramma_vakleergebied" rel="entiteit-examenprogramma_vakleergebied"></template>

                            <template data-simply-template="examenprogramma_bg_profiel" rel="entiteit-examenprogramma_bg_profiel"></template>
                            <template data-simply-template="examenprogramma_bg_kern" rel="entiteit-examenprogramma_bg_kern"></template>
                            <template data-simply-template="examenprogramma_bg_module" rel="entiteit-examenprogramma_bg_module"></template>
                            <template data-simply-template="examenprogramma_bg_keuzevak" rel="entiteit-examenprogramma_bg_keuzevak"></template>
                            <template data-simply-template="examenprogramma_bg_kerndeel" rel="entiteit-examenprogramma_bg_kerndeel"></template>
                            <template data-simply-template="examenprogramma_bg_deeltaak" rel="entiteit-examenprogramma_bg_deeltaak"></template>
                            <template data-simply-template="examenprogramma_bg_moduletaak" rel="entiteit-examenprogramma_bg_moduletaak"></template>
                            <template data-simply-template="examenprogramma_bg_keuzevaktaak" rel="entiteit-examenprogramma_bg_keuzevaktaak"></template>
                            <template data-simply-template="examenprogramma_bg_globale_eindterm" rel="entiteit-examenprogramma_bg_globale_eindterm"></template>

                            <template data-simply-template="kerndoel" rel="entiteit-kerndoel"></template>
                            <template data-simply-template="kerndoel_domein" rel="entiteit-kerndoel_domein"></template>
                            <template data-simply-template="kerndoel_uitstroomprofiel" rel="entiteit-kerndoel_uitstroomprofiel"></template>
                            <template data-simply-template="kerndoel_vakleergebied" rel="entiteit-kerndoel_vakleergebied"></template>
                            <template data-simply-template="syllabus" rel="entiteit-syllabus"></template>
                            <template data-simply-template="syllabus_vakbegrip" rel="entiteit-syllabus_vakbegrip"></template>
                            <template data-simply-template="syllabus_toelichting" rel="entiteit-syllabus_toelichting"></template>
                            <template data-simply-template="syllabus_specifieke_eindterm" rel="entiteit-syllabus_specifieke_eindterm"></template>
                            <template data-simply-template="leerlingtekst" rel="entiteit-leerlingtekst"></template>
                        </div>
                    </div>
                </article>
            </template>
            <template data-simply-template="new">
                <article class="slo-card slo-grid-span-3">
                    <header class="slo-card-header slo-space">
                        <span class="slo-right">
                              <button class="slo-button slo-right" data-simply-command="save">Bewaar</button>
                        </span>
                        <span class="slo-tag">
                            <label class="slo-tag-label">
                                <svg class="slo-icon slo-icon-feather">
                                    <use xlink:href="/files/feather-sprite.svg#link">
                                </use></svg>
                            </label>
                            <span class="slo-id" data-simply-field="entity.id"></span>
                        </span>
                        <span class="slo-tag">
                            <label class="slo-tag-label">Type</label>
                            <select class="slo-entity-select" data-simply-field="entity.section">
                                <option value="leerlijn">leerlijn</option>
                                <option value="vakkencluster">vakkencluster</option>
                                <option value="vakleergebied">vakleergebied</option>
                                <option value="lpib_vakleergebied">lpib_vakleergebied</option>
                                <option value="lpib_vakkern">lpib_vakkern</option>
                                <option value="lpib_vaksubkern">lpib_vaksubkern</option>
                                <option value="lpib_vakinhoud">lpib_vakinhoud</option>
                                <option value="doelniveau">doelniveau</option>
                                <option value="doel">doel</option>
                                <option value="niveau">niveau</option>
                                <option value="examenprogramma">examenprogramma</option>
                                <option value="examenprogramma_domein">examenprogramma_domein</option>
                                <option value="examenprogramma_subdomein">examenprogramma_subdomein</option>
                                <option value="examenprogramma_eindterm">examenprogramma_eindterm</option>
                                <option value="examenprogramma_kop1">examenprogramma_kop1</option>
                                <option value="examenprogramma_kop2">examenprogramma_kop2</option>
                                <option value="examenprogramma_kop3">examenprogramma_kop3</option>
                                <option value="examenprogramma_kop4">examenprogramma_kop4</option>
                                <option value="examenprogramma_body">examenprogramma_body</option>
                                <option value="examenprogramma_vakleergebied">examenprogramma_vakleergebied</option>
                                <option value="examenprogramma_bg_profiel">examenprogramma_bg_profiel</option>
                                <option value="examenprogramma_bg_kern">examenprogramma_bg_kern</option>
                                <option value="examenprogramma_bg_module">examenprogramma_bg_module</option>
                                <option value="examenprogramma_bg_keuzevak">examenprogramma_bg_keuzevak</option>
                                <option value="examenprogramma_bg_kerndeel">examenprogramma_bg_kerndeel</option>
                                <option value="examenprogramma_bg_deeltaak">examenprogramma_bg_deeltaak</option>
                                <option value="examenprogramma_bg_moduletaak">examenprogramma_bg_moduletaak</option>
                                <option value="examenprogramma_bg_keuzevaktaak">examenprogramma_bg_keuzevaktaak</option>
                                <option value="examenprogramma_bg_globale_eindterm">examenprogramma_bg_globale_eindterm</option>
                                <option value="kerndoel">kerndoel</option>
                                <option value="kerndoel_domein">kerndoel_domein</option>
                                <option value="kerndoel_uitstroomprofiel">kerndoel_uitstroomprofiel</option>
                                <option value="kerndoel_vakleergebied">kerndoel_vakleergebied</option>
                                <option value="syllabus">syllabus</option>
                                <option value="syllabus_vakbegrip">syllabus_vakbegrip</option>
                                <option value="syllabus_toelichting">syllabus_toelichting</option>
                                <option value="syllabus_specifieke_eindterm">syllabus_specifieke_eindterm</option>
                                <option value="leerlingtekst">leerlingtekst</option>
                                <option value=""></option>

                            </select>
                        </span>
                    </header>
                    <div class="slo-card-body" data-simply-field="entity.section" data-simply-content="template" data-simply-default-value="default">
                        <template data-simply-template="vakkencluster" rel="entiteit-vakkencluster"></template>
                        <template data-simply-template="leerlijn" rel="entiteit-leerlijn"></template>
                        <template data-simply-template="vakleergebied" rel="entiteit-vakleergebied"></template>
                        <template data-simply-template="lpib_vakleergebied" rel="entiteit-lpib_vakleergebied"></template>
                        <template data-simply-template="lpib_vakkern" rel="entiteit-lpib_vakkern"></template>
                        <template data-simply-template="lpib_vaksubkern" rel="entiteit-lpib_vaksubkern"></template>
                        <template data-simply-template="lpib_vakinhoud" rel="entiteit-lpib_vakinhoud"></template>
                        <template data-simply-template="doelniveau" rel="entiteit-doelniveau"></template>
                        <template data-simply-template="doel" rel="entiteit-doel"></template>
                        <template data-simply-template="niveau" rel="entiteit-niveau"></template>
                        <template data-simply-template="examenprogramma" rel="entiteit-examenprogramma"></template>
                        <template data-simply-template="examenprogramma_domein" rel="entiteit-examenprogramma_domein"></template>
                        <template data-simply-template="examenprogramma_subdomein" rel="entiteit-examenprogramma_subdomein"></template>
                        <template data-simply-template="examenprogramma_eindterm" rel="entiteit-examenprogramma_eindterm"></template>
                        <template data-simply-template="examenprogramma_kop1" rel="entiteit-examenprogramma_kop1"></template>
                        <template data-simply-template="examenprogramma_kop2" rel="entiteit-examenprogramma_kop2"></template>
                        <template data-simply-template="examenprogramma_kop3" rel="entiteit-examenprogramma_kop3"></template>
                        <template data-simply-template="examenprogramma_kop4" rel="entiteit-examenprogramma_kop4"></template>
                        <template data-simply-template="examenprogramma_body" rel="entiteit-examenprogramma_body"></template>
                        <template data-simply-template="examenprogramma_vakleergebied" rel="entiteit-examenprogramma_vakleergebied"></template>
                        <template data-simply-template="examenprogramma_bg_profiel" rel="entiteit-examenprogramma_bg_profiel"></template>
                        <template data-simply-template="examenprogramma_bg_kern" rel="entiteit-examenprogramma_bg_kern"></template>
                        <template data-simply-template="examenprogramma_bg_module" rel="entiteit-examenprogramma_bg_module"></template>
                        <template data-simply-template="examenprogramma_bg_keuzevak" rel="entiteit-examenprogramma_bg_keuzevak"></template>
                        <template data-simply-template="examenprogramma_bg_kerndeel" rel="entiteit-examenprogramma_bg_kerndeel"></template>
                        <template data-simply-template="examenprogramma_bg_deeltaak" rel="entiteit-examenprogramma_bg_deeltaak"></template>
                        <template data-simply-template="examenprogramma_bg_moduletaak" rel="entiteit-examenprogramma_bg_moduletaak"></template>
                        <template data-simply-template="examenprogramma_bg_keuzevaktaak" rel="entiteit-examenprogramma_bg_keuzevaktaak"></template>
                        <template data-simply-template="examenprogramma_bg_globale_eindterm" rel="entiteit-examenprogramma_bg_globale_eindterm"></template>
                        <template data-simply-template="kerndoel" rel="entiteit-kerndoel"></template>
                        <template data-simply-template="kerndoel_domein" rel="entiteit-kerndoel_domein"></template>
                        <template data-simply-template="kerndoel_uitstroomprofiel" rel="entiteit-kerndoel_uitstroomprofiel"></template>
                        <template data-simply-template="kerndoel_vakleergebied" rel="entiteit-kerndoel_vakleergebied"></template>
                        <template data-simply-template="syllabus" rel="entiteit-syllabus"></template>
                        <template data-simply-template="syllabus_vakbegrip" rel="entiteit-syllabus_vakbegrip"></template>
                        <template data-simply-template="syllabus_toelichting" rel="entiteit-syllabus_toelichting"></template>
                        <template data-simply-template="syllabus_specifieke_eindterm" rel="entiteit-syllabus_specifieke_eindterm"></template>
                        <template data-simply-template="leerlingtekst" rel="entiteit-leerlingtekst"></template>
                    </div>
                </article>
            </template>
            <template data-simply-template="multipleparents">
                <div data-simply-list="multipleparents" data-simply-data="multipleparents">
                </div>
            </template>
            </div>
            <div style="position: absolute; right: 12em; margin-top: .5em;">
                <div class="slo-form-field" data-simply-field="entity.deleted" data-simply-content="template" data-simply-default-template="0" data-simply-default-value="0">
                    <template data-simply-template="0">
                        <label class="slo-form-checkbox">
                            <input type="checkbox" name="dirty" id="dirty" value="1" data-simply-field="entity.dirty"> <span class="slo-label">Inhoudelijk gewijzigd sinds de vorige release.</span>
                        </label>
                        <!-- div class="slo-form-help">
                            Als dit vinkje aan staat, betekend het dat deze entiteit bij de volgende release een nieuwe UUID krijgt. Het is belangrijk dat dit altijd gebeurd bij inhoudelijke wijzigingen. Alleen als je bijv. een typefout corrigeert mag je dit vinkje uitzetten. Let erop dat je dit alleen doet als
                            het vinkje voor de correctie al uit stond.
                        </div -->
                    </template>
                    <template data-simply-template="1">
                    </template>
                </div>
            </div>
        </div>
    </main>

    <dialog id="login" class="slo-login">
        <header class="bg-brand">
            <img src="/assets/img/slo.png" class="slo-logo">
        </header>
        <section class="body">
            <div class="slo-warning" data-simply-field="login-error"></div>
            <div class="slo-warning">Aanmelden met uw Github account</div>
            <form data-simply-command="login" method="POST">
                <div class="group">
                    <label>
                        Naam
                        <input type="text" name="username" id="username" data-simply-field="username" data-simply-element="username">
                    </label>
                </div>
                <div class="group">
                    <label>
                        Wachtwoord
                        <input type="password" name="password" data-simply-field="password" data-simply-element="password">
                    </label>
                </div>
                <div class="group">
                    <label>
                        <input type="checkbox" name="savelogin" value="1" data-simply-field="savelogin" data-simply-element="savelogin">
                        Bewaar mijn logingegevens op deze computer
                    </label>
                </div>
                <br>
                <button type="submit" class="slo-button slo-button-primary">Login
                    <div class="ripples buttonRipples"><span class="ripplesCircle"></span></div>
                </button>
            </form>
        </section>
    </dialog>
    
    <div class="slo-dialog-overlay"></div>


<script src="https://canary.simplyedit.io/1/simply-edit.js" xsrc="https://yvo.muze.nl/simply-edit/js/simply-edit.js" xsrc="https://cdn.simplyedit.io/1/simply-edit.js" data-simply-storage="none"></script>
<script src="js/GitHub.bundle.js"></script>
<script src="/assets/simplyview/dist/simply.everything.js"></script>
<script>
    simply.route.init({
        root: '/entiteiten-editor/'
    });
</script>

<script src="https://unpkg.com/json-schema-ref-parser@6.0.0/dist/ref-parser.min.js"></script>
<script src="https://unpkg.com/lodash@4.17.11/lodash.min.js"></script>
<script src="js/curriculum.js"></script>
<script>
    simply.bind = false;

    var niveauIndex = [];
    var reverseNiveauIndex = {};

    var reverseDoelIndex = {};
    var hierarchies = {
        'doel': {
            'lpib_vakleergebied':['lpib_vakkern_id','doelniveau_id'],
            'lpib_vakkern':['lpib_vaksubkern_id','doelniveau_id'],
            'lpib_vaksubkern':['lpib_vakinhoud_id','doelniveau_id'],
            'lpib_vakinhoud':['doelniveau_id'],
            'doelniveau':['doel_id'] // ,'niveau_id']
        },
		'leerdoelenkaarten': {
			'ldk_vakleergebied': ['ldk_vakkern_id','doelniveau_id'],
            'ldk_vakkern':['ldk_vaksubkern_id','doelniveau_id'],
            'ldk_vaksubkern':['ldk_vakinhoud_id','doelniveau_id'],
            'ldk_vakinhoud':['doelniveau_id'],
            'doelniveau':['doel_id'] // ,'niveau_id']
		},
        'examenprogramma': {
            'examenprogramma':['examenprogramma_domein_id','examenprogramma_kop1_id'],
            'examenprogramma_domein':['examenprogramma_eindterm_id', 'examenprogramma_subdomein_id'],
            'examenprogramma_subdomein':['examenprogramma_eindterm_id'],
            'examenprogramma_kop1':['examenprogramma_kop2_id', 'examenprogramma_body_id'],
            'examenprogramma_kop2':['examenprogramma_kop3_id', 'examenprogramma_body_id'],
            'examenprogramma_kop3':['examenprogramma_kop4_id', 'examenprogramma_body_id'],
            'examenprogramma_kop4':['examenprogramma_body_id']
        },
        'examenprogramma_bg': {
            'examenprogramma_bg_profiel': ['examenprogramma_bg_kern','examenprogramma_bg_module','examenprogramma_bg_keuzevak'],
            'examenprogramma_bg_kern': ['examenprogramma_bg_kerndeel'],
            'examenprogramma_bg_kerndeel': ['examenprogramma_bg_globale_eindterm'],
            'examenprogramma_bg_module': ['examenprogramma_bg_deeltaak','examenprogramma_bg_moduletaak'],
            'examenprogramma_bg_deeltaak': ['examenprogramma_bg_globale_eindterm'],
            'examenprogramma_bg_keuzevak': ['examenprogramma_bg_deeltaak','examenprogramma_bg_keuzevaktaak']
        },
        'kerndoelen': {
            'kerndoel_domein' : ['kerndoel_id'],
            'kerndoel_vakleergebied' : ['kerndoel_uitstroomprofiel_id', 'kerndoel_id', 'kerndoel_domein_id']
        }
    };
    function walk(hierarchy, node, parents, callback) {
        var hier = hierarchies[hierarchy];
        var type = node.section;
        callback(node, parents);
        var childParents = parents.slice();
        childParents.push(node);
        if (hier[type]) {
            hier[type].forEach(function(prop) {
                if (node[prop]) {
                    node[prop].forEach(function(childId) {
                        var child = curriculum.index.id[childId];
                        if (!child) {
                            console.error('Missing child id: '+childId+' in '+prop, node);
                        } else {
                            walk(hierarchy, curriculum.index.id[childId], childParents, callback);
                        }
                    });
                }
            });
        }
    }

    editor.transformers = {
        "round" : {
            "render" : function(data) {
                return Math.round(100 * (1-data),2) + "%";
            }
        },
        "opendatalink" : {
            "render" : function(data) {
                this._data = data;
                data = "https://opendata.slo.nl/curriculum/api-acpt/v1/uuid/"+data;
                return data;
            },
            "extract": function() {
                return this._data;
            }
        },
        "editlink" : {
            "render" : function(data) {
                return {
                    innerHTML : data,
                    href : document.location.pathname + "#edit/" + data
                };
            },
            "extract" : function(el) {
                return el.innerHTML;
            }
        },
        "uuid": {
            "render": function(data) {
                this.id = data;
                return data;
            }
        },
        "idToTitle": {
            "render" : function(data) {
                this.sloId = data;
                var entity = clone(curriculum.index.id[data]);
                if (curriculum.index.type[data] == "doelniveau") {
                    if (entity.doel_id && entity.doel_id[0]) {
                        var doel = clone(curriculum.index.id[entity.doel_id[0]]);
                    } else if (entity.kerndoel_id && entity.kerndoel_id[0]) {
                        var doel = clone(curriculum.index.id[entity.kerndoel_id[0]]);
                    }
                    if (entity.niveau_id && entity.niveau_id[0]) {
                        var niveau = clone(curriculum.index.id[entity.niveau_id[0]]);
                    }
                    var result = '';
                    if (niveau && niveau.title ) {
                        result += '['+niveau.title+'] ';
                    } else {
                        result += '[geen niveau]';
                    }
                    if (doel && doel.title) {
                        result += doel.title;
                    } else {
                        result += 'geen doel';
                    }
                    return result;
                } else {
                    if (typeof curriculum.index.id[data] == 'undefined') {
                        return 'missing';
                    }
                    return curriculum.index.id[data].title ? clone(curriculum.index.id[data].title) : "";
                }
            },
            "extract" : function(el) {
                return this.sloId;
            }
        },
        "hasDescription" : {
            render : function(data) {
                return (typeof data.description !== "undefined");
            }
        },
        "hasTitle" : {
            render : function(data) {
                return (typeof data.title !== "undefined");
            }
        },
        "isarray" : {
            render : function(data) {
                this.data = data;
                return Array.isArray(data);
            },
            extract : function(el) {
                return this.data;
            }
        },
        "searchoption" : {
            render : function(entity) {
                entity = clone(entity);
                this.data = entity;
                var option = entity.title + " " + entity.id;

                if (curriculum.index.type[entity.id]=="doelniveau") {
                    var doel = clone(curriculum.index.id[entity.doel_id[0]]);
                    var niveau = clone(curriculum.index.id[entity.niveau_id[0]]);
                    option = "[" + niveau.title + "] " + doel.title + " " + entity.id;
                }

                return {
                    innerHTML : option,
                    value : entity.id
                };
            },
            extract : function(el) {
                return this.data;
            }
        }
    };

    var emptyEntity = function() {
        return {
            lpib_vakkern_id : [],
            lpib_vaksubkern_id : [],
            lpib_vakinhoud_id : [],
            ldk_vakkern_id: [],
            ldk_vaksubkern_id: [],
            ldk_vakinhoud_id: [],
            doelniveau_id : [],
            doel_id : [],
            niveau_id : [],
            section: null,
            id: null,
            dirty: 0,
            deleted: 0
        };
    };
    
    var originalEntities = {}; // store to keep unchanged originals so we can revert with delete-change
    
    var entityEditor = simply.app({
        container: document.body,
        routes : {
            '/#edit/:id' : function(params) {
                entityEditor.actions.showEntity(params.id);
                editor.pageData.page = "edit";
                editor.pageData.rootEntity = params.id;
                entityEditor.actions.hideTreeView();
                window.scrollTo(0,0);
            },
            '/#edit/' : function(params) {
                // reset page;
                editor.pageData.entity = emptyEntity();
                editor.pageData.page = "edit";
                editor.pageData.rootEntity = null;
                entityEditor.actions.hideTreeView();
                window.scrollTo(0,0);
            },
            '/#new/' : function(params) {
                // reset page;
                editor.pageData.entity = emptyEntity();
                editor.pageData.page = "new";
                editor.pageData.rootEntity = null;
                entityEditor.actions.hideTreeView();
                window.scrollTo(0,0);
            },
            '/#multipleparents/' : function(params) {
                // reset page;
                editor.pageData.entity = emptyEntity();
                editor.pageData.page = "multipleparents";
                editor.pageData.rootEntity = null;
                entityEditor.actions.hideTreeView();
                window.scrollTo(0,0);
            }
        },
        commands: {
            toggleAddRelation: function(el, value) {
                el.closest('.slo-treeview-title').nextElementSibling.querySelector('.slo-treeview-add-relation').classList.toggle('slo-hidden');
            },
            toggleRelation: function(el, value) {
                // remove this entity as a child from its tree parent
                var ids = value.split(':');
                var childId = ids[1];
                var parentId = ids[0];
                if (entityEditor.actions.toggleRelation(parentId, childId)) {
                    el.closest('.slo-treeview-title').classList.remove('slo-removed');
                } else {
                    el.closest('.slo-treeview-title').classList.add('slo-removed');
                }
            },
            showEntity: function(el, value) {
                var selected = Array.from(document.querySelectorAll('.slo-treeview-title.slo-selected'));
                if (selected.length) {
                    selected.forEach(function(el) {
                        el.classList.remove('slo-selected');
                    });
                }
                entityEditor.actions.showEntity(value);
                var selected = document.querySelector('.slo-treeview-title[data-simply-value="'+value+'"]');
                if (selected) {
                    selected.classList.add('slo-selected');
                }
            },
            logoff: function() {
            localStorage.removeItem('login');
            location.reload(true);
            },
            login: function(form, values) {
                document.body.dataset.loading="true";
                return entityEditor.actions.start(values.username, values.password)
                .then(function() {
                    document.body.dataset.loading="false";
                    document.getElementById('login').removeAttribute('open');
                    entityEditor.view['login-error'] = '';
                    if (values.savelogin) {
                        localStorage.setItem('login',JSON.stringify(values));
                    }
                    return true;
                })
                .then(function() {
                        if (typeof LogRocket != 'undefined') {
                            LogRocket.identify(values.username);
                        }
                    return true;
                })
                .catch(function(error) {
                    if (error.path=='/user') {
                        entityEditor.view['login-error'] = 'Github login mislukt';
                        document.body.dataset.loading="false";
                        return false;
                    } else {
                        document.getElementById('login').removeAttribute('open');
                        entityEditor.view['login-error'] = '';
                        if (values.savelogin) {
                            localStorage.setItem('login',JSON.stringify(values));
                        }
                        throw error;
                    }
                });
            },
            'toggleTree': function(el) {
                if (!editor.pageData.schemas.length) {
                    var section = curriculum.index.type[editor.pageData.rootEntity];
                    editor.pageData.schemas = [curriculum.getSchemaFromType(section)];
                }
                entityEditor.actions.renderTree(curriculum.index.id[editor.pageData.rootEntity],editor.pageData.niveau)
                .then(function() {
                    document.body.querySelector('.slo-treeview').classList.toggle('slo-hidden');
                });
            },
            'search': function(el) {
                var searchInput = el.parentElement.querySelector('input');
                var searchText = searchInput.value;
                searchInput.value = '';
                return entityEditor.actions.search(searchText);
            },
            'new': function(el) {
                simply.route.goto(document.location.pathname + '#new');
            },
            'multipleparents': function(el) {
                simply.route.goto(document.location.pathname + '#multipleparents');
            },
            'delete-relation' : function(el) {
                rememberScrollPosition();
                el.parentNode.parentNode.removeChild(el.parentNode);
            },
            'add-relation' : function(el) {
                var relationInput = el.parentNode.querySelector("input");
                var relationId = relationInput.value;
                var relation = el.getAttribute("data-slo-relation");
                if (editor.pageData.entity[relation] == null) {
                    editor.pageData.entity[relation] = [];
                }

                var exists = editor.pageData.entity[relation].filter(function(id) {
                    return (''+id) == relationId;
                });
                if (!exists.length) {
                    if (curriculum.index.id[relationId]) {
                        rememberScrollPosition();
                        editor.pageData.entity[relation].push(relationId);
                        // fix for a bug in simply edit where the list / binding gets broken somehow;
                        for (var i=0; i<editor.pageData.entity._bindings_[relation].elements.length; i++) {
                            editor.pageData.entity._bindings_[relation].bind(editor.pageData.entity._bindings_[relation].elements[i]);
                        }
                        window.setTimeout(function() {
                            window.scrollPosition = undefined;
                        }, 350);
                        relationInput.value = '';
                    } else {
                        // add new entity first
                        entityEditor.actions.newEntityForm(relation, editor.pageData.entity.id);

                    }
                }
            },
            'delete-change' : function(el) {
                // find the id of the entity;
                var id = el.closest('.slo-entiteit-change').querySelector("a").innerHTML;
                if (originalEntities[id]) {
                    var original = clone(originalEntities[id]);
                    delete originalEntities[id];
                       curriculum.index.id[id] = original;
                    //FIXME: update curriculum.data as well?
                } else {
                    delete curriculum.index.id[id];
                    if (editor.pageData.entity && editor.pageData.entity.id == id) {
                        editor.pageData.entity = {};
                    }
                }
                
                el.parentNode.parentNode.removeChild(el.parentNode);
                editor.pageData.changeCount = editor.pageData.changes.length;
                localStorage.changes = JSON.stringify(editor.pageData.changes);

                  if (editor.pageData.rootEntity) {
                       var root = curriculum.index.id[editor.pageData.rootEntity];
                    entityEditor.actions.renderTree(root, editor.pageData.niveau, editor.pageData.schemas);
                }
                
                // reload the page to show the changes;
                if (editor.pageData.entity) {
                    var entityId = editor.pageData.entity.id;
                    if (entityId == id) {
                        if (curriculum.index.id[id]) {
                            entityEditor.actions.showEntity(id);
                        } else if (editor.pageData.rootEntity) {
                            entityEditor.actions.showEntity(editor.pageData.rootEntity);
                        } else {
                            simply.route.goto(document.location.pathname + '#new/');
                        }
                    }                                    
                } else {
                    simply.route.goto(document.location.pathname + '#new/');
                }
            },
            'commit-changes' : function() {
                document.body.dataset.loading="true";
                entityEditor.actions['commit-changes'](editor.pageData.changes, editor.pageData.commitMessage)
                .then(function(done) {
                    done.sort().reverse().forEach(function(changeIndex) {
                        editor.pageData.changes.splice(changeIndex, 1);
                    })
                    editor.pageData.changeCount = editor.pageData.changes.length;
                    localStorage.changes = JSON.stringify(editor.pageData.changes);
                    editor.pageData.commitMessage = '';
                    document.body.dataset.loading="false";
                })
                .then(function() {
                    if (editor.pageData.rootEntity) {
                        var root = curriculum.index.id[editor.pageData.rootEntity];
                        entityEditor.actions.renderTree(root, editor.pageData.niveau, editor.pageData.schemas);
                    }
                })
                .catch(function(error) {
                    document.body.dataset.loading="false";
                    alert(error);
                });
            },
            'save' : function() {
                if (!editor.pageData.entity.id) {
                    editor.pageData.entity.id = curriculum.uuidv4();
                }
                entityEditor.actions.save(clone(editor.pageData.entity));
                   if (editor.pageData.rootEntity) {
                       var root = curriculum.index.id[editor.pageData.rootEntity];
                    entityEditor.actions.renderTree(root, editor.pageData.niveau, editor.pageData.schemas);
                }                
            },
            deprecate: function() {
                if (editor.pageData.entity.id) {
                    if (confirm('Weet u zeker dat u deze entiteit wil verwijderen?')) {
                        var changedEntity = clone(editor.pageData.entity);
                        changedEntity.deleted = 1;
                        entityEditor.actions.save(changedEntity);          
                    }
                }
            },
            filterNiveau: function(select, value) {
                var entity = clone(editor.pageData.entity);
                editor.pageData.niveau = value;
                entityEditor.actions.renderTree(entity, value, editor.pageData.schemas);
            },
            filterSchemas: function(select, values) {
                var entity = clone(editor.pageData.entity);
                editor.pageData.schemas = values;
                entityEditor.actions.renderTree(entity, editor.pageData.niveau, values);
            }
        },
        actions: {
            toggleRelation: function(parentId, childId) {
                // fetch entity
                var entity = clone(curriculum.index.id[parentId]);
                var childType = curriculum.index.type[childId];
                // update
                if (!entity[childType+'_id'] || entity[childType+'_id'].indexOf(childId)===-1) { // restore
                    entity[childType+'_id'].push(childId);
                    entity.children.push(childId);
                    // add to changes
                    entityEditor.actions.save(entity);
                    return true;
                } else { // remove
                    entity[childType+'_id'] = entity[childType+'_id'].filter(function(id) {
                        return id!=childId;
                    });
                    entity.children = entity.children.filter(function(id) {
                        return id!=childId;
                    });
                    // add to changes
                    entityEditor.actions.save(entity);
                    return false;
                }
            },
            hideTreeView: function() {
                var tree = document.querySelector('.slo-treeview');
                if (tree) {
                    tree.classList.add('slo-hidden');
                }
            },
            showEntity: function(id) {
                editor.pageData.entity = emptyEntity();
                if (curriculum.index.id[id]) {
                    editor.pageData.entity = clone(curriculum.index.id[id]);
                    //show the edit entity form
                     if (typeof editor.pageData.entity.dirty === "undefined") {
                           editor.pageData.entity.dirty = 0;
                    }
                } else {
                    alert('Onbekend id '+id);
                }
            },
            newEntityForm: function(relation, parentId) {
                if (editor.pageData.entity.parent) {
                    entityEditor.actions.save(clone(editor.pageData.entity));
                }
                var entity = emptyEntity();
                entity.id = curriculum.uuidv4();
                entity.section = relation.substr(0, relation.length-3);
                entity.dirty = 0;
                entity.parent = parentId;
                //show the new entity form
                editor.pageData.entity = entity;
            },
            'renderTree': function(entity, niveau=null, contexts=null) {
                document.body.dataset.loading="true";
                if (niveau) {
                    var niveauIndexData = niveauIndex.filter(function(niveauData) {
                        return niveauData.niveau_id == niveau;
                    }).pop();
                }
                var getContextFromId = function(id) {
                    var section = curriculum.index.type[id];
                    var context = Object.keys(curriculum.schemas).filter(function(schema) {
                        return typeof curriculum.schemas[schema].properties[section]!='undefined';
                    }).pop();
                    return context;
                };
                var render = function(e,contexts,niveau=null,parent) {
                    if (!e) {
                        return '<span class="slo-treeview-title"><span class="slo-tag"></span>Missing</span>';
                    }
                    if (niveau && !e.niveau_id && (!reverseNiveauIndex[e.id] || reverseNiveauIndex[e.id].indexOf(niveau)===-1)) {
                        if (!reverseNiveauIndex[e.id]) {
                            console.error('missing reverse niveau index for '+e.id);
                            console.log(e);
                        }
                        return '';
                    }
                    if (niveau && e.niveau_id && e.niveau_id.indexOf(niveau)===-1) {
                        return '';
                    }
                    var title = (e.prefix ? e.prefix + ' ' + e.title : (e.title ? e.title : e.id));
                    if (curriculum.index.type[e.id]=='doelniveau') {
                    	title = getDoelNiveauTitle(e);                    	
                    }
                    var result = '<span class="slo-treeview-title" data-simply-command="showEntity" data-simply-value="'+e.id+'" title="'+escapeQuotes(title)+'">';
                    if (parent) {
                        result += '<a class="slo-remove-button slo-button slo-button-naked';
                        result += '" data-simply-command="toggleRelation" data-simply-value="'+parent.id+':'+e.id+'">×</a>';
                    }
                    
                    result += '<span class="slo-tag">'+e.section+'</span><span class="slo-title">'+title+'</span></span>';
                    if (!contexts) {
                        contexts = [];
                        contexts.push(getContextFromId(e.id));
                    }
                    result += '<div class="slo-treeview-children">';
                    if (!e.children) {
                        e.children = [];
                    }
                    e.children.forEach(function(c) {
                        if (contexts.indexOf(getContextFromId(c))!=-1 && curriculum.index.type[c]!='vakleergebied') {
                            result += render(curriculum.index.id[c], contexts, niveau, e);
                        }
                    });
                    result += '</div>';
                    return result;
                };
                var tree = document.querySelector('.slo-treeview-tree');
                var treeHTML = render(entity, contexts, niveau);
                $('.slo-treeview-schemas').val(contexts);
                $('.slo-treeview-schemas').trigger("chosen:updated");
                tree.innerHTML = treeHTML;
                document.body.dataset.loading="false";
                return Promise.resolve(true);
            },
            'showLogin': function() {
                 document.getElementById('login').setAttribute('open','open');
                 entityEditor.view['login-error'] = '';
                 return Promise.resolve(true);
            },
            'autologin': function(username, password) {
                document.body.dataset.loading="true";
                return entityEditor.actions.start(username, password)
                .then(function() {
                    document.body.dataset.loading="false";
                    return true;
                })
                .then(function() {
                    if (typeof LogRocket != 'undefined') {
                        LogRocket.identify(username);
                    }                    
                    return true;
                })
                .catch(function(error) {
                    if (error.path == '/user') {
                        document.getElementById('login').setAttribute('open','open');
                        entityEditor.view['login-error'] = '';
                        document.body.dataset.loading="false";
                        return false;
                    } else {
                        document.getElementById('login').removeAttribute('open');
                        entityEditor.view['login-error'] = '';
                        throw error;
                    }
                });
            },
            'search': function(searchText) {
                  if (curriculum.index.id[searchText]) {
                      simply.route.goto(document.location.pathname + "#edit/" + searchText);
                  }
            },
            addChangedEntity: function(entity) {
                editor.pageData.changes = editor.pageData.changes.filter(function(entry) {
                    if (entity.id == entry.id) {
                        return false;
                    }
                    return true;
                });
                editor.pageData.changes.push(clone(entity));
                if (curriculum.index.id[entity.id] && !originalEntities[entity.id]) {
                    // keep the unchanged version in case we need to revert
                    var original = curriculum.data[curriculum.index.type[entity.id]]
                        .filter(function(e) {return e.id == entity.id; })
                        .pop();
                    if (original) {
                        originalEntities[entity.id] = clone(original);
                    }
                }
                curriculum.index.id[entity.id] = entity;
                curriculum.index.type[entity.id] = entity.section;
                
                editor.pageData.changeCount = editor.pageData.changes.length;
                localStorage.changes = JSON.stringify(editor.pageData.changes);    
            },
            save: function(entity) {
                if (entity.parent) {
                    var parent = clone(curriculum.index.id[entity.parent]);
                    if (parent) {
                        if (typeof parent[entity.section+'_id'] == 'undefined') {
                            parent[entity.section+'_id'] = [];
                        }
                        parent[entity.section+'_id'].push(entity.id);
                        parent.children.push(entity.id);
                        entityEditor.actions.addChangedEntity(parent);
                    }
                    delete entity.parent;
                }
                entityEditor.actions.addChangedEntity(entity);
            },
            'commit-changes': function(changes, message) {
                if (!message) {
                    return Promise.reject('Commit message required');
                }
                var done = [];
                var schemas = {};
                changes.forEach(function(change, changeIndex) {
                    if (!change.commit) {
                        return false;
                    }
                    var id = change.id;
                    var original = curriculum.data[curriculum.index.type[id]].find(function(entry) {
                        if (entry.id == id) {
                            return true;
                        }
                        return false;
                    });
//                    delete change.section;
//                    delete change.parents;
                    if (original) {
                        var index = curriculum.data[curriculum.index.type[id]].indexOf(original);
                        curriculum.data[curriculum.index.type[id]][index] = change;
                    } else {
                        curriculum.data[curriculum.index.type[id]].push(change);
                    }
                    var section = curriculum.index.type[change.id];
                    var schema = curriculum.getSchemaFromType(section);
                    if (!schemas[schema]) {
                        schemas[schema] = [];
                    }
                    schemas[schema].push(section);
                    done.push(changeIndex);
                });
                var clean = function(dataset) {
                    dataset = clone(dataset);
                    dataset.forEach(function(entity) {
                        delete entity.section;
                        delete entity.parents;
                        delete entity.children;
                        delete entity.commit;
                        if (!entity.dirty || entity.dirty==="0") {
                            delete entity.dirty;
                        }
                        if (!entity.deleted || entity.deleted==="0") {
                            delete entity.deleted;
                        }
                        Object.keys(entity).forEach(function(p) {
                            if (Array.isArray(entity[p]) && entity[p].length==0) {
                                delete entity[p];
                            }
                        });
                        //FIXME: remove any properties that aren't part of the schema
                        //except dirty and deleted?
                    });
                    return dataset;
                };
                var files = [];
                Object.keys(schemas).forEach(function(schema) {
                    schemas[schema].forEach(function(section) {
                        var filename = curriculum.schemas[schema].properties[section]['#file'];
                        files.push({ path: filename, data: JSON.stringify(clean(curriculum.data[section]), null, "\t"), schema: schema});
                    });
                });
                return new Promise(function(resolve, reject) {
                    var errors = {};
                    var writeFile = function() {
                        if (!files.length) {
                            if (Object.keys(errors).length) {
                                //FIXME: some changes may have been committed correctly...
                                return reject(errors);
                            } else {
                                return resolve(done);
                            }
                        }
                        var file = files.shift();
                        return curriculum.sources[file.schema].writeFile(file.path, file.data, message).then(writeFile);
                    }
                    return writeFile();
                }).then(function() {
                    // clear originals because revert is no longer an option
                    originalEntities = {};
                    return done;
                });
//              return curriculum.sources[schema].writeFiles(files, message);
            },
            filterNiveau: function(niveauId) {
                entityEditor.actions.renderTree(editor.pageData.entityId,niveauId);
            },
            start: function(user, pass) {
                var schemas = {
                    'curriculum-lpib': 'slonl/curriculum-lpib',
                    'curriculum-basis': 'slonl/curriculum-basis',
                    'curriculum-kerndoelen': 'slonl/curriculum-kerndoelen',
                    'curriculum-examenprogramma': 'slonl/curriculum-examenprogramma',
                    'curriculum-examenprogramma-bg': 'slonl/curriculum-examenprogramma-bg',
                    'curriculum-syllabus': 'slonl/curriculum-syllabus',
                    'curriculum-doelgroepteksten': 'slonl/curriculum-doelgroepteksten',
                    'curriculum-leerdoelenkaarten': 'slonl/curriculum-leerdoelenkaarten'
                };
                var branch = 'editor';
                var loading = [];
                Object.keys(schemas).forEach(function(schema) {
                    loading.push(
                        curriculum.loadContextFromGithub(schema, schemas[schema], user, pass, branch)
                        .then(function() {
                            return curriculum.loadData(schema);
                        })
                    );
                });

                   // get user info
                   // put it in the editor.pageData.user
                   // name and avatar_url
                   var gh = new GitHub({username:user, password: pass});
                   return gh.getUser().getProfile()
                   .then(function(profile) {
                       editor.pageData.user = profile.data;
                      document.body.classList.add('slo-logged-on');
                      return profile;
                   })
                .then(function(profile) {
                    return Promise.all(loading);
                 })
                .then(function() {
                    Object.values(curriculum.index.id).forEach(function(entity) {
                        entity.section = curriculum.index.type[entity.id];
                        entity.children = [];
                        Object.keys(entity).forEach(function(prop) {
                            if (prop.substr(prop.length-3)=='_id' && prop!='niveau_id') {
                                entity.children = entity.children.concat(entity[prop]);
                            }
                        });
                    });

                    var counter = 1000;
                    Object.keys(curriculum.data).forEach(function(dataset) {
                        if (dataset!='deprecated') {
                            editor.addDataSource(dataset, {
                                load : function(el, callback) {
                                    document.body.dataset.loading = "true";
                                    var options = '';
                                    curriculum.data[dataset].forEach(function(entity) {
                                        var option = entity.title;

                                        if (curriculum.index.type[entity.id] == "doelniveau") {
                                            var doel;
                                            var niveau;
                                            if (entity.doel_id) {
                                                doel = curriculum.index.id[entity.doel_id[0]];
                                            }
                                            if (entity.kerndoel_id) {
                                                doel = curriculum.index.id[entity.kerndoel_id[0]];
                                            }
                                            if (entity.eindterm_id) {
                                                doel = curriculum.index.id[entity.eindterm_id[0]];
                                            }
                                            if (entity.niveau_id) {
                                                niveau = curriculum.index.id[entity.niveau_id[0]];
                                            }
                                            if (doel && niveau) {
                                                option = "[" + niveau.title + "] " + doel.title;
                                            }
                                        }
                                        if (navigator.userAgent.indexOf('Chrome/') === -1) {
                                            option += ' ' + entity.id;
                                        }
                                        options += "<option value='" + entity.id + "'>" + option + "</option>";
                                    });
                                    window.setTimeout(function() {
                                        el.innerHTML = options;
                                        el.dataset.simplyDataName = dataset;
                                        document.body.dataset.loading = "false";
                                    }, counter);
                                    counter+=1000;
                                }
                            });
                        }
                    });
                    
                    var parentInfo = {
                        'lpib_vakleergebied' : 'doel',
                        'examenprogramma' : 'examenprogramma',
                        'kerndoel_vakleergebied': 'kerndoelen',
                        'examenprogramma_bg_profiel': 'examenprogramma_bg',
                    	'ldk_vakleergebied': 'doel'
                    };
                    Object.keys(parentInfo).forEach(function(section) {
                        curriculum.data[section].forEach(function(vakEntity) {
                            walk(parentInfo[section], vakEntity, [], function(entity, parents) {
                                if (!entity.parents) {
                                    entity.parents = [];
                                }
                                parents.map(function(parent) {
                                    if (parent.id) {
                                        return {
                                            id : clone(parent.id),
                                            type : clone(parent.section),
                                            ids : [{id : clone(parent.id)}]
                                        }
                                    }
                                })
                                .filter(Boolean)
                                .map(function(parent) {
                                    var add = true;
                                    entity.parents.forEach(function(item) {
                                        if (item.type == parent.type) {
                                            // check if the new parent already is in the ids list;
                                            var dups = item.ids.filter(function(el) {
                                                if (el.id == parent.id) {
                                                    return true;
                                                }
                                            });
                                            if (dups.length == 0) {
                                                item.ids.push({id : parent.id});
                                            }
                                            add = false;
                                        }
                                    });
                                    if (add) {
                                        entity.parents.push(parent);
                                    }
                                });
                            });
                        });
                    });
					// add fake parent and children links for vakleergebied in each lpib_vakkern
/*					curriculum.data['lpib_vakkern'].forEach(function(vakkern) {
						if (vakkern.vakleergebied_id && vakkern.vakleergebied_id.length) {
							vakkern.vakleergebied_id.forEach(function(vakleergebied_id) {
								vakkern.parents.push({
									id: vakleergebied_id,
									ids: [ vakleergebied_id ],
									type: curriculum.index.type[vakleergebied_id]
								});
								var vak = curriculum.index.id[vakleergebied_id];
								if (!vak.children) {
									vak.children = [];
								}
								vak.children.push(vakkern.id);
							});
						}
					});
*/
                    editor.addDataSource("entities", {
                        load : function(el, callback) {
                            document.body.dataset.loading = "true";
                            var options = '';

                            // Priorities for sorting - we want the higher level entities to come first in the list.
                            var priorities = {
                                "vakleergebied" : 5,
								"lpib_vakleergebied" : 4,
                                "leerlijn" : 3,
                                "examenprogramma" : 2,
                                "examenprogramma_bg": 1,
								"ldk_vakleergebied": 0
                            };

                            var isChrome = navigator.userAgent.indexOf('Chrome/')!==-1;
                            
                            Object.values(curriculum.index.id)
                            .sort(function(a, b) {
                                if (priorities[a.section]) {
                                    if (priorities[b.section]) {
                                        if (priorities[a.section] > priorities[b.section]) {
                                            return -1;
                                        }
                                        if (priorities[a.section] < priorities[b.section]) {
                                            return 1;
                                        }
                                        if (a.title > b.title) {
                                            return 1;
                                        }
                                        if (a.title < b.title) {
                                            return -1;
                                        }
                                    } else {
                                        return -1;
                                    }
                                }
                                if (priorities[b.section]) {
                                    return 1;
                                }
                                return 0;
                            }).forEach(function(entity) {
                                var option = curriculum.index.type[entity.id]+': '+entity.title;

                                if (curriculum.index.type[entity.id] == "doelniveau") {
                                    var doel;
                                    var niveau;
                                    if (entity.doel_id) {
                                        doel = curriculum.index.id[entity.doel_id[0]];
                                    }
                                    if (entity.kerndoel_id) {
                                        doel = curriculum.index.id[entity.kerndoel_id[0]];
                                    }
                                    if (entity.eindterm_id) {
                                        doel = curriculum.index.id[entity.eindterm_id[0]];
                                    }
                                    if (entity.niveau_id) {
                                        niveau = curriculum.index.id[entity.niveau_id[0]];
                                    }
                                    if (doel && niveau) {
                                        option = "[" + niveau.title + "] " + doel.title;
                                    }
                                }
                                if (!isChrome) {
                                    option += ' ' + entity.id;
                                }
                                if (!entity.deleted && curriculum.index.type[entity.id] != 'deprecated') {
                                    options += "<option value='" + entity.id + "'>" + option + "</option>";
                                }
                            });
                            window.setTimeout(function() {
                                el.innerHTML = options;
                                document.body.dataset.loading = "false";
                            });
                        }
                    });

                    function getNiveauIndex(niveauId) {
                        var niveauOb = niveauIndex.filter(function(niveauOb) {
                            return niveauOb.niveau_id == niveauId;
                        }).pop();
                        if (!niveauOb) {
                            niveauOb = {
                                niveau_id: niveauId,
                            };
                            niveauIndex.push(niveauOb);
                        }
                        return niveauOb;
                    }

                    function onlyUnique(value, index, self) {
                        return self.indexOf(value)===index;
                    }

                    function addParentsToNiveauIndex(parents, niveaus) {
                        if (!niveaus || !niveaus.forEach) {
                            return;
                        }
                        niveaus.forEach(function(niveauId) {
                            var niveau = getNiveauIndex(niveauId);
                            parents.forEach(function(parentEntry) {
                                var parentId = parentEntry.id;
                                var parent = curriculum.index.id[parentId];
                                if (!parent) {
                                    console.log('missing parent '+parentId);
                                    return;
                                }
                                if (!niveau[parent.section+'_id']) {
                                    niveau[parent.section+'_id'] = [];
                                }
                                if (niveau[parent.section+'_id'].indexOf(parentId)==-1) {
                                    niveau[parent.section+'_id'].push(parentId);
                                }
                                if (typeof parent.parents != 'undefined') {
                                    addParentsToNiveauIndex(parent.parents, niveaus);
                                }
                            });
                        });
                        parents.forEach(function(parentEntry) {
                            var parentId = parentEntry.id;
                            if (!reverseNiveauIndex[parentId]) {
                                reverseNiveauIndex[parentId] = [];
                            }
                            reverseNiveauIndex[parentId] = reverseNiveauIndex[parentId].concat(niveaus).filter(onlyUnique);
                        });
                    }

                    //FIXME: examenprogramma_eindterm ook aan niveauIndex toevoegen
                    curriculum.data.doelniveau
                    .concat(curriculum.data.examenprogramma_eindterm)
                    .forEach(function(entity) {
                        if (entity.niveau_id && entity.parents) {
                            addParentsToNiveauIndex(entity.parents, entity.niveau_id);
                            entity.niveau_id.forEach(function(niveauId) {
                                var index = getNiveauIndex(niveauId);
                                if (typeof index.doel_id == 'undefined') {
                                    index.doel_id = [];
                                }
                                if (entity.doel_id) {
                                    entity.doel_id.forEach(function(doelId) {
                                        if (index.doel_id.indexOf(doelId)==-1) {
                                            index.doel_id.push(doelId);
                                        }
                                    });
                                }
                                if (entity.kerndoel_id) {
                                    entity.kerndoel_id.forEach(function(doelId) {
                                        //FIXME: make index.kerndoel_id?
                                        if (index.doel_id.indexOf(doelId)==-1) {
                                            index.doel_id.push(doelId);
                                        }
                                    });
                                }
                            });
                        }
                    });

                    editor.pageData.niveaus = [{ niveau: { value: '', innerHTML: 'Selecteer niveau'} }]
                        .concat(niveauIndex.map(function(n) {
                            return {
                                niveau: {
                                    value: n.niveau_id,
                                    innerHTML: curriculum.index.id[n.niveau_id].title
                                }
                            };
                        }));
                    editor.addDataSource('schemas', {
                        load: Object.keys(curriculum.schemas).map(function(s) {
                            return {
                                schema: {
                                    value: s,
                                    innerHTML: s
                                }
                            };
                        })
                    });
                    editor.addDataSource('multipleparents', {
                        load: function(el, callback) {
                            var result = Object.values(curriculum.index.id)
                            .filter(function(entry) {
                                if(
                                    entry.parents &&
                                    entry.parents.length &&
                                    entry.parents[entry.parents.length-1].ids.length > 1
                                ) {
                                    return true;
                                } else {
                                    return false;
                                }
                            })
							var newHtml = '';
							result.forEach(function(item) {
								newHtml += '<a href="#edit/' + item.id + '">' + item.id + '</a><br>';
							});
							el.innerHTML = newHtml;
                        }
                    });
                    
                    simply.activate.addListener('context-select', function() {
                        var s = new vanillaSelectBox('.slo-treeview-schemas', {'placeHolder':'Selecteer contexten'});
                    });
                    // restore changes from localstorage;
                    if (localStorage.changes) {
                        editor.pageData.changes = JSON.parse(localStorage.changes);
                        editor.pageData.changeCount = editor.pageData.changes.length;
                        editor.pageData.changes.forEach(function(entry) {
                            if (curriculum.index.id[entry.id]) {
                                originalEntities[entry.id] = clone(curriculum.index.id[entry.id]);
                            }
                            curriculum.index.id[entry.id] = clone(entry);
                            curriculum.index.type[entry.id] = entry.section;
                        });
                    }
                    document.body.dataset.loading = "false";
                    simply.route.handleEvents();
                    simply.route.match();
                    return true;
                });
            }
        }
    });

	function escapeQuotes(s) {
		return s.replace('"','\x22').replace("'",'\x27');
	}
	
	function getDoelNiveauTitle(entity) {
		if (!entity.niveau_id || !Array.isArray(entity.niveau_id) || !entity.niveau_id.length) {
			var niveau = 'geen';
		} else {
			var niveau = entity.niveau_id.map(function(id) {
				return  curriculum.index.id[id].title;
			}).join(',');
		}
		var title = [];
		['doel_id','kerndoel_id','examenprogramma_eindterm_id','examenprogramma_subdomein_id','examenprogramma_domeid_id'].forEach(function(prop) {
			if (entity[prop] && Array.isArray(entity[prop]) && entity[prop].length) {
				entity[prop].forEach(function(childId) {
					title.push(prop.substr(0,prop.length-3)+': '+curriculum.index.id[childId].title);
				});
			}
		});
		return '('+niveau+') '+'['+(title.length)+'] '+title.join(',');
	}
	
    (function() {
        var login;
        var loginString = localStorage.getItem('login');
        if (loginString) {
            try {
                login = JSON.parse(loginString);
            } catch(e) {
            }
        }
        if (login) {
            entityEditor.actions.autologin(login.username, login.password);
        } else {
            entityEditor.actions.showLogin();
        }
    })();
    
    function clone(ob) {
        if (typeof ob == 'undefined' || ob == null) {
            return null;
        }
        return JSON.parse(JSON.stringify(ob));
    }


    // Yucky code, but chrome handles large datalists very poorly. This is to make it only do autocompletion
    // when enough characters have been entered. Firefox doesn't even break a sweat with this;
    if (window.chrome) {
        document.addEventListener("input", function(evt) {
            if (evt.target.hasAttribute("list") && !evt.target.hasAttribute("data-list")) {
                evt.target.setAttribute("data-list", evt.target.getAttribute("list"));
            }
            if (evt.target.getAttribute("data-list")) {
                if (evt.target.value.length > 3) {
                    evt.target.setAttribute("list", evt.target.getAttribute("data-list"));
                } else {
                    evt.target.removeAttribute("list");
                }
            }
        }, true);
    }


    simply.activate.addListener('autosize', function() {
        var self = this;
        self.style.height = 'auto';
        self.style.height = (self.scrollHeight+2)+'px';
           this.addEventListener('input',function(evt) {
            window.setTimeout(function() {
                self.style.height = 'auto';
                self.style.height = (self.scrollHeight+2)+'px';
            },0);
        });
    });

    var lpibMatches = {};
    var reverseLpibMatches = {};
    function checkLPIBMatch() {
        fetch('lpib-matches.json').then(function(data) {
            return data.json();
        })
        .then(function(json) {
            lpibMatches = json;
            // fix bk:ids, load reverse of matches
            Object.keys(lpibMatches).forEach(function(lpibId) {
                lpibMatches[lpibId].forEach(function(obkId, index) {
                    if (obkId.substr(0,3)==='bk:') {
                        obkId = obkId.substr(3);
                        lpibMatches[lpibId][index] = obkId;
                    }
                    if (!reverseLpibMatches[obkId]) {
                        reverseLpibMatches[obkId] = [];
                    }
                    reverseLpibMatches[obkId].push(lpibId);
                });
            });
            // find matches that have n to m relations
            // lpibMatches[x] has more than 1 entry
            // and reverseLpibMatches[y] for at least on of those entries has more than 1 entry
            var lpibN = Object.keys(lpibMatches).filter(function(lpibId) {
                return lpibMatches[lpibId].length>1;
            });
            lpibNM = lpibN.filter(function(lpibId) {
                var M = false;
                lpibMatches[lpibId].forEach(function(obkId) {
                    if (reverseLpibMatches[obkId].length>1) {
                        M = true;
                    }
                });
                return M;
            });
            lpibNM.forEach(function(lpibId) {
                var lpEnt = curriculum.index.id[lpibId];
                console.group('N to M link:')
                console.log('From '+lpEnt.id+' '+lpEnt.title);
                lpibMatches[lpibId].forEach(function(obkId) {
                    if (reverseLpibMatches[obkId].length>1) {
                        var obkEnt = curriculum.index.id[obkId];
                        console.log('To '+obkEnt.id+' '+obkEnt.title);
                        console.group('Which also links to:')
                        reverseLpibMatches[obkId].forEach(function(lpibId) {
                            var lpEnt2 = curriculum.index.id[lpibId];
                            console.log(lpEnt2.id+' '+lpEnt2.title);
                        });
                        console.groupEnd();
                    }
                });
                console.groupEnd();
            });
        })
        .catch(function(err) {
            console.error(err);
        });
    }

    /* Code to remember scroll position when the lists are changed and redrawn */
    function rememberScrollPosition() {
        window.scrollPosition = {
            y: window.scrollY,
            x: window.scrollX
        };
    }
    window.addEventListener("databind:elementresolved", function(evt) {
        window.setTimeout(function() {
            delete window.scrollPosition;
        }, 200);
    });

    window.addEventListener("scroll", function(evt) {
        if (typeof window.scrollPosition !== "undefined") {
            window.scrollTo(window.scrollPosition.x, window.scrollPosition.y);
        }
    });
</script>
</body>
</html>